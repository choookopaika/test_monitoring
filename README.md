# Тестовое задание

Написать скрипт на bash для мониторинга процесса test в среде linux 
(реализовано на дистрибутиве **kali linux**).

## Созданы 4 файла:
| Название | Назначение     | 
| :-------- | :------- | 
| `test.sh` | **скрипт мониторинга** | 
| `test.service` | **systemd unit**, запускающий скрипт | 
| `test.timer` | **systemd таймер**, запускающий **test.service** при старте системы и каждую минуту | 
| `monitoring.log` | **лог-файл** | 


## test.sh:
- Опрашивает процесс с именем test. 
- Если процесс не найден-скрипт завершает работу.
- Если процесс найден, сравнивает его PID с предыдущим (который сохраняется в /var/run/test_last_pid)
- Если процесс запущен, скриптт делает https-запрос: в случае ответа с кодом 200 в лог поступает строка [ok] Server responded with 200 OK, в ином случае [error] Monitoring server unreachable: https://test.com/monitoring/test/api.

## test.service: 
- Запускает скрипт один раз.
## test.timer: 
- Запускает test.service при старте системы и затем каждую минуту.

## Скрипт отвечает следующим требованиям:
1) Запускается при запуске системы.

`Настроен таймер test.timer для запуска скрипта через минуту после загрузки системы.`

2) Отрабатывает каждую минуту.
  
`В test.timer стоит onunitactivesec=1min, который запускаеи скрипт каждую минуту.`

3) Если процесс запущен, то стучится (по https) на https://test.com/monitoring/test/api.
  
`В скрипте проверка pgrep, затем curl к url.`

4) Если процесс был перезапущен, пишет в лог /var/log/monitoring.log (если процесс не запущен, то ничего не делает)

`В логе есть соответствующие записи `
```bash
[info] process 'test' restarted. Old PID: 39952, New PID: 40047
```

5) Если сервер мониторинга не доступен, так же пишет в лог.

`В логе есть соответствующие записи`
```bash
[error] Monitoring server unreachable: https://test.com/monitoring/test/api
```
